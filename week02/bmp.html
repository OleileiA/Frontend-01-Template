<!doctype html>
<html lang="zh-cn">
<head>
	<meta charset="UTF-8">
	<meta name="viewport"
		  content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
</head>
<body>
<div>&#ffff;</div>
<script>
  var sizeof = function(str, charset){
         var total = 0,
             charCode,
             i,
             len;
         charset = charset ? charset.toLowerCase() : '';

         if (charset === 'utf-16' || charset === 'utf16') {
               for(i = 0, len = str.length; i < len; i++){
                     charCode = str.charCodeAt(i);
                     if(charCode <= 0xffff){
                           total += 2;
                       }else{
                           total += 4;
                       }
                 }
           }
         else {
               for(i = 0, len = str.length; i < len; i++){
                     charCode = str.charCodeAt(i);
                     if(charCode <= 0x007f) {
                           total += 1;
                       }else if(charCode <= 0x07ff){
                           total += 2;
                       }else if(charCode <= 0xffff){
                           total += 3;
                       }else{
                           total += 4;
                       }
                 }
		 }
         return total;
     };


     console.log(sizeof("哈哈哈", "utf16"));
</script>
</body>
</html>